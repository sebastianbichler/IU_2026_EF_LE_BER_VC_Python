{% extends "layout.html" %}
{% block content %}
<h2>Bestellungen</h2>

<h3>Neue Bestellung aufgeben</h3>
<form method="POST">
    <label>Kunde:
        <select name="customer_idx">
            {% for idx, cust in enumerate(customers) %}
            <option value="{{ idx }}">{{ cust.name }}</option>
            {% endfor %}
        </select>
    </label>
    <label>Gemuese auswaehlen (Mehrfachauswahl mit Strg/Cmd):
        <select name="veg_indices" multiple>
            {% for idx, veg in enumerate(vegetables) %}
            <option value="{{ idx }}">{{ veg.name }} ({{ veg.sort }})</option>
            {% endfor %}
        </select>
    </label>
    <label>Lieferzeit (Tage): <input type="number" name="days" required></label>
    <label>Preis (Euro): <input type="number" step="0.01" name="price" required></label>
    <button type="submit">Bestellen</button>
</form>

<h3>Bestellhistorie</h3>
<ul>
    {% for order in orders %}
    <li>
        <strong>{{ order.customer.name }}:</strong>
        {% for v in order.vegetables %}{{ v.name }}{% if not loop.last %}, {% endif %}{% endfor %}
        - {{ order.price }} Euro (Lieferung: {{ order.delivery_date.strftime('%d.%m.%Y') }})
    </li>
    {% else %}
    <li>Keine Bestellungen vorhanden.</li>
    {% endfor %}
</ul>
{% endblock %}